<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>First Mapbox Map</title>
  <!-- Mapbox CSS -->
  <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.53.0/mapbox-gl.css' rel='stylesheet' />
  <!-- Custom CSS -->
  <style>
    #map {
      /* the width and height may be set to any size */
      width: 100%;
      height: 700px;
    }
.mapboxgl-popup-content {
  background-color: lightcyan;
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
}
  </style>
</head>
<body>

<h1>My First Mapbox Map!</h1>

<!-- The HTML element that serves as the Mapbox container -->
<div id='map'></div>

<!-- Mapbox JS -->
<script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.53.0/mapbox-gl.js'></script>
<script src="js/keys.js"></script>
<script src="js/mapbox_functions.js"></script>

<!-- Custom JS -->
<script>

  var allRest = [
    {
      name: "Golden Dragon",
      location: [-98.52921778721883, 29.54246088109029],
      genre: "Chinese",
      favorite: "Sesame Chicken",
      fancy: "to-go only",
      picture: '<img style="height: 350px; width: 350px" src="images/goldendragon.avif" alt="melting pot">'
    }
    ,
    {
      name: "Alamo Cafe",
      location: [-98.56639349278312, 29.53400714410293],
      genre: "Mexican",
      favorite: "Beef Fajitas",
      fancy: "casual",
      picture: '<img style="height: 350px; width: 350px" src="images/almaocafe.jpeg" alt="melting pot">'

    },
    {
      name: "Chama Gaucha",
      location: [-98.49776993142787, 29.610348803763284],
      genre: "Steakhouse",
      favorite: "Bottom Sirloin",
      fancy: "fancy",
      picture: '<img style="height: 350px; width: 350px" src="images/chama.png" alt="melting pot">'

    },
    {
      name: "Melting Pot",
      location: [-98.5147339355575, 29.578811916560774],
      genre: "Fondue",
      favorite: "Dessert",
      fancy: "Fancy with a capital F",
      picture: '<img style="height: 350px; width: 350px" src="images/meltingpot.jpeg" alt="melting pot">'
    }
  ]

  mapboxgl.accessToken = mapBoxKey;
  var map = new mapboxgl.Map({
    container: 'map',
    style: 'mapbox://styles/mapbox/streets-v9',
    zoom: 15,
    center: [-98.52921778721883, 29.54246088109029],
  });
  map.addControl(new mapboxgl.GeolocateControl({
    positionOptions: {
      enableHighAccuracy: true
    },
    trackUserLocation: true,
    showUserHeading: true
  }));


  function displayInfo(x) {
    const marker = new mapboxgl.Marker()
            .setLngLat(x.location)
            .addTo(map);
    const pop = new mapboxgl.Popup()
            .setHTML("<p style='font-weight: bold; font-size: 16px; text-align: center'>" + x.name + ' is in the ' + x.genre + ' genre. My favorite dish there is ' + x.favorite + ' and it is ' + x.fancy + ".</p> <br> " + x.picture)
    marker.setPopup(pop);
    console.log(x.name);
    console.log(x.location);
    console.log(x.genre);
    console.log(x.favorite);
    console.log(x.fancy);
  }

  // FOR EACH FUNCTION CALLED
  allRest.forEach(displayInfo);






  // var popup = new mapboxgl.Popup()
  //         .setLngLat([-98.52921778721883, 29.54246088109029])
  //         .setHTML("<p style='font-weight: bold; font-size: 24px; color: darkgoldenrod'>Golden Dragon Express</p>")
  //         .addTo(map)

</script>
</body>
</html>